<meta charset="utf-8">

<h1><%= @mix.name %></h1>

<div id="library" data-no-turbolink>
  <h3>library</h3>
  <ul id="library">
<% if current_musician.library.samples.length == 0 %>
you don't have any samples. add them to your library <%= link_to 'here', samples_path %>
<% else %>
(click 'use' to add them to the song. drag the squares around to the right time. then click the 'play&gt')
<% end %>
    <% current_musician.library.samples.each{|s| %>
    <li sampleId="<%= s.id %>">
      <span class="name"><%= s.name %></span>
      <audio src="<%= s.audio.url %>" controls></audio>
      <%= link_to '(use)', '#', onclick: "addSample(#{s.id}); return false;"%>
    </li>
    <% } %>
  </ul>
</div>

<div id="editor">

  <div>
    <%= link_to 'play>', '#', onclick: 'tPlay(); return false;' %>
  </div>
  <div id="tracks">

    <% @tracks.each{|track| %>
      <div class="track" sampleId="<%= track.id %>">

        <% Importage.find(:all, :conditions => {:sample_id => track.id, :mix_id => @mix.id}).each {|importage| %>
          <div class="sample ui-widget-content" 
               sampleId="<%= track.id %>" 
               importageId="<%=importage.id%>"
               style="left: <%=importage.start_time / @xToTimeConst%>px"> 
            <p><%= track.name %>
            <audio src="<%= importage.sample.audio.url %>"></audio></p>
          </div>
        <% } %>
      </div>
    <% } %>
  </div>
</div>

<script type="text/javascript">
  var mixId = <%= @mix.id %>;
</script>
